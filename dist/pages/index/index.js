"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
var log_factory_1 = require("../../logs/log.factory");
var http_base_1 = require("../../https/http.base");
var api_const_1 = require("../../api/api.const");
var util_1 = require("../../utils/util");
var app = getApp();
var log = log_factory_1.LogFactory.get("Index");
var http = new http_base_1.HttpBase();
Page({
    data: {
        StatusBar: app.globalData.StatusBar,
        CustomBar: app.globalData.CustomBar,
        bannerList: [],
        hotList: [],
        recList: [],
        pi: 1,
        ps: 10
    },
    onLoad: function () {
        console.log(this.data.CustomBar);
        wx.showLoading({
            title: '加载中...'
        });
        Promise.all([
            this.getBanner(),
            this.getHotGoods(),
            this.getRecGoods()
        ]).then(function (res) {
            wx.hideLoading({ success: function () { } });
        });
    },
    getBanner: function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            http.get(api_const_1.Apis.banner.queryBanner, { data: { pi: _this.data.pi, ps: _this.data.ps, nbhd: "N00001" } }).then(function (res) {
                var data = res;
                log.log("banner-list: ", res);
                if (!util_1.isEmpty(data.result)) {
                    _this.setData({
                        bannerList: data.result
                    });
                }
                else {
                    log.log(util_1.getPageUrl() + 'banner无数据', res);
                }
                resolve(true);
            }).catch(function (res) {
                log.log(util_1.getPageUrl() + "banner接口", res);
                reject(true);
            });
        });
    },
    getHotGoods: function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            http.get(api_const_1.Apis.hot.queryOfNbhd, { data: { pi: _this.data.pi, ps: _this.data.ps, nbhd: "N00001" } }).then(function (res) {
                var data = res;
                log.log("hot-list: ", data);
                if (!util_1.isEmpty(data.result)) {
                    data.result.map(function (item) {
                        item.cate = "hot";
                        item.url = "pages/good/index?url=" + api_const_1.Apis.hot.restful.get + "&&id=" + item.id;
                    });
                    _this.setData({
                        hotList: data.result
                    });
                }
                else {
                    log.log(util_1.getPageUrl() + "hotgood无数据", data);
                }
                resolve(true);
            }).catch(function (res) {
                log.log(util_1.getPageUrl() + "hotgood接口", res);
                reject(true);
            });
        });
    },
    getRecGoods: function () {
        var _this = this;
        return new Promise(function (resolve, reject) {
            http.get(api_const_1.Apis.rec.queryOfMy, { data: { pi: _this.data.pi, ps: _this.data.ps, nid: "N00001", uid: "U100000003" } }).then(function (res) {
                var data = res;
                if (!util_1.isEmpty(data.result)) {
                    data.result.map(function (item) {
                        item.cate = "rec";
                        item.url = "/pages/good/index?url=" + api_const_1.Apis.rec.restful.get + "&&id=" + item.id;
                        var num = parseFloat(item.retailprice);
                        item.retailprice = num.toFixed(2);
                    });
                    _this.setData({
                        recList: data.result
                    });
                }
                else {
                    log.log(util_1.getPageUrl() + "recgood接口", res);
                }
                resolve(true);
            }).catch(function (res) {
                log.log(util_1.getPageUrl() + "recgood接口", res);
                reject(true);
            });
        });
    },
    addCart: function (e) {
        log.log('addCartListener: ', e);
    }
});

//# sourceMappingURL=data:application/json;charset=utf8;base64,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QUFDLENBQUMsS0FBSyxDQUFDLFVBQUEsR0FBRztnQkFDVixHQUFHLENBQUMsR0FBRyxDQUFDLGlCQUFVLEVBQUUsR0FBRyxXQUFXLEVBQUUsR0FBRyxDQUFDLENBQUE7Z0JBQ3hDLE1BQU0sQ0FBQyxJQUFJLENBQUMsQ0FBQTtZQUNkLENBQUMsQ0FBQyxDQUFBO1FBQ0osQ0FBQyxDQUFDLENBQUE7SUFFSixDQUFDO0lBQ0QsT0FBTyxZQUFDLENBQU07UUFDWixHQUFHLENBQUMsR0FBRyxDQUFDLG1CQUFtQixFQUFHLENBQUMsQ0FBQyxDQUFBO0lBQ2xDLENBQUM7Q0FDRixDQUFDLENBQUEiLCJmaWxlIjoicGFnZXMvaW5kZXgvaW5kZXguanMiLCJzb3VyY2VzQ29udGVudCI6WyIvL2luZGV4LmpzXG4vL+iOt+WPluW6lOeUqOWunuS+i1xuaW1wb3J0IHsgSU15QXBwIH0gZnJvbSAnLi4vLi4vYXBwJ1xuaW1wb3J0IHsgTG9nRmFjdG9yeSB9IGZyb20gJy4uLy4uL2xvZ3MvbG9nLmZhY3RvcnknXG5pbXBvcnQge0h0dHBCYXNlfSBmcm9tICcuLi8uLi9odHRwcy9odHRwLmJhc2UnXG5pbXBvcnQge0lDb21tb25SZXNwb25zZX0gZnJvbSAnLi4vLi4vaHR0cHMvaHR0cC5pbnRlcmZhY2UnXG5pbXBvcnQge0FwaXN9IGZyb20gJy4uLy4uL2FwaS9hcGkuY29uc3QnXG5pbXBvcnQge2lzRW1wdHksIGdldFBhZ2VVcmx9IGZyb20gJy4uLy4uL3V0aWxzL3V0aWwnXG5jb25zdCBhcHAgPSBnZXRBcHA8SU15QXBwPigpXG5jb25zdCBsb2cgPSBMb2dGYWN0b3J5LmdldChcIkluZGV4XCIpO1xuY29uc3QgaHR0cCA9IG5ldyBIdHRwQmFzZSgpXG5QYWdlKHtcbiAgZGF0YToge1xuICAgIFN0YXR1c0JhcjogYXBwLmdsb2JhbERhdGEuU3RhdHVzQmFyLFxuICAgIEN1c3RvbUJhcjogYXBwLmdsb2JhbERhdGEuQ3VzdG9tQmFyLFxuICAgIGJhbm5lckxpc3Q6IFtdLFxuICAgIGhvdExpc3Q6IFtdLFxuICAgIHJlY0xpc3Q6IFtdLFxuICAgIHBpOiAxLFxuICAgIHBzOiAxMFxuICB9LCAgXG4gIG9uTG9hZCgpIHsgICBcbiAgICBjb25zb2xlLmxvZyh0aGlzLmRhdGEuQ3VzdG9tQmFyKVxuICAgIHd4LnNob3dMb2FkaW5nKHtcbiAgICAgIHRpdGxlOiAn5Yqg6L295LitLi4uJ1xuICAgIH0pXG4gICAgUHJvbWlzZS5hbGwoW1xuICAgICAgdGhpcy5nZXRCYW5uZXIoKSxcbiAgICAgIHRoaXMuZ2V0SG90R29vZHMoKSxcbiAgICAgIHRoaXMuZ2V0UmVjR29vZHMoKVxuICAgIF0pLnRoZW4ocmVzID0+IHtcbiAgICAgIHd4LmhpZGVMb2FkaW5nKHtzdWNjZXNzOiAoKTogdm9pZCA9PiB7fX0pXG4gICAgfSlcbiAgIFxuICB9LCBcbiAgLy8gYmFubmVy5YiX6KGoXG4gIGdldEJhbm5lcigpIHtcbiAgICBsZXQgX3RoaXMgPSB0aGlzXG4gICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHtcbiAgICAgIGh0dHAuZ2V0KEFwaXMuYmFubmVyLnF1ZXJ5QmFubmVyLHtkYXRhOiB7cGk6X3RoaXMuZGF0YS5waSwgcHM6IF90aGlzLmRhdGEucHMsIG5iaGQ6XCJOMDAwMDFcIn19KS50aGVuKHJlcyA9PiB7XG4gICAgICAgIGNvbnN0IGRhdGE6IElDb21tb25SZXNwb25zZSA9IHJlcyBcbiAgICAgICAgbG9nLmxvZyhcImJhbm5lci1saXN0OiBcIiAsIHJlcylcbiAgICAgICAgaWYgKCFpc0VtcHR5KGRhdGEucmVzdWx0KSkgeyAgICAgICAgXG4gICAgICAgICAgX3RoaXMuc2V0RGF0YSEoe1xuICAgICAgICAgICAgYmFubmVyTGlzdDogZGF0YS5yZXN1bHRcbiAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxvZy5sb2coZ2V0UGFnZVVybCgpICsgJ2Jhbm5lcuaXoOaVsOaNricsIHJlcylcbiAgICAgICAgfVxuICAgICAgIHJlc29sdmUodHJ1ZSlcbiAgICAgIH0pLmNhdGNoKHJlcyA9PnsgXG4gICAgICAgIGxvZy5sb2coZ2V0UGFnZVVybCgpICsgXCJiYW5uZXLmjqXlj6NcIiwgcmVzKVxuICAgICAgICByZWplY3QodHJ1ZSlcbiAgICAgIH0pXG4gICAgfSkgICAgXG4gIH0sXG4gIC8vIOeDreWNluWVhuWTgVxuICBnZXRIb3RHb29kcygpe1xuICAgIGxldCBfdGhpcyA9IHRoaXNcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgaHR0cC5nZXQoQXBpcy5ob3QucXVlcnlPZk5iaGQsIHtkYXRhOntwaTpfdGhpcy5kYXRhLnBpLCBwczogX3RoaXMuZGF0YS5wcywgbmJoZDpcIk4wMDAwMVwifX0pLnRoZW4ocmVzID0+IHtcbiAgICAgICAgY29uc3QgZGF0YTogSUNvbW1vblJlc3BvbnNlID0gcmVzIFxuICAgICAgICBsb2cubG9nKFwiaG90LWxpc3Q6IFwiLCBkYXRhKVxuICAgICAgICBpZighaXNFbXB0eShkYXRhLnJlc3VsdCkpIHtcbiAgICAgICAgICBkYXRhLnJlc3VsdC5tYXAoKGl0ZW06IGFueSk9PiB7XG4gICAgICAgICAgICBpdGVtLmNhdGUgPSBcImhvdFwiICBcbiAgICAgICAgICAgIGl0ZW0udXJsID0gYHBhZ2VzL2dvb2QvaW5kZXg/dXJsPSR7QXBpcy5ob3QucmVzdGZ1bC5nZXR9JiZpZD0ke2l0ZW0uaWR9YFxuICAgICAgICAgIH0pXG4gICAgICAgICAgX3RoaXMuc2V0RGF0YSEoe1xuICAgICAgICAgICAgaG90TGlzdDogZGF0YS5yZXN1bHRcbiAgICAgICAgICB9KVxuICAgICAgICB9IGVsc2Uge1xuICAgICAgICAgIGxvZy5sb2coZ2V0UGFnZVVybCgpICsgXCJob3Rnb29k5peg5pWw5o2uXCIsIGRhdGEpXG4gICAgICAgIH1cbiAgICAgICAgcmVzb2x2ZSh0cnVlKVxuICAgICAgfSkuY2F0Y2gocmVzID0+IHtcbiAgICAgICAgbG9nLmxvZyhnZXRQYWdlVXJsKCkgKyBcImhvdGdvb2TmjqXlj6NcIiwgcmVzKVxuICAgICAgICByZWplY3QodHJ1ZSlcbiAgICAgIH0pXG4gICAgfSkgICBcbiAgfSxcbiAgLy8g5o6o6I2Q5ZWG5ZOBXG4gIGdldFJlY0dvb2RzKCkge1xuICAgIGxldCBfdGhpcyA9IHRoaXNcbiAgICByZXR1cm4gbmV3IFByb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4ge1xuICAgICAgaHR0cC5nZXQoQXBpcy5yZWMucXVlcnlPZk15LCB7ZGF0YToge3BpOiBfdGhpcy5kYXRhLnBpLCBwczogX3RoaXMuZGF0YS5wcywgbmlkOiBcIk4wMDAwMVwiLCB1aWQ6IFwiVTEwMDAwMDAwM1wifX0pLnRoZW4ocmVzID0+IHtcbiAgICAgICAgY29uc3QgZGF0YTogSUNvbW1vblJlc3BvbnNlID0gcmVzXG4gICAgICAgIGlmKCFpc0VtcHR5KGRhdGEucmVzdWx0KSkge1xuICAgICAgICAgIGRhdGEucmVzdWx0Lm1hcCgoaXRlbTogYW55KSA9PiB7XG4gICAgICAgICAgICBpdGVtLmNhdGUgPSBcInJlY1wiICBcbiAgICAgICAgICAgIGl0ZW0udXJsID0gYC9wYWdlcy9nb29kL2luZGV4P3VybD0ke0FwaXMucmVjLnJlc3RmdWwuZ2V0fSYmaWQ9JHtpdGVtLmlkIH1gXG4gICAgICAgICAgICBsZXQgbnVtID0gcGFyc2VGbG9hdChpdGVtLnJldGFpbHByaWNlKVxuICAgICAgICAgICAgaXRlbS5yZXRhaWxwcmljZSA9IG51bS50b0ZpeGVkKDIpXG4gICAgICAgICAgfSlcbiAgICAgICAgICBfdGhpcy5zZXREYXRhISh7XG4gICAgICAgICAgICByZWNMaXN0OiBkYXRhLnJlc3VsdFxuICAgICAgICAgIH0pXG4gICAgICAgIH0gZWxzZSB7XG4gICAgICAgICAgbG9nLmxvZyhnZXRQYWdlVXJsKCkgKyBcInJlY2dvb2TmjqXlj6NcIiwgcmVzKVxuICAgICAgICB9XG4gICAgICAgIHJlc29sdmUodHJ1ZSlcbiAgICAgIH0pLmNhdGNoKHJlcyA9PiB7XG4gICAgICAgIGxvZy5sb2coZ2V0UGFnZVVybCgpICsgXCJyZWNnb29k5o6l5Y+jXCIsIHJlcylcbiAgICAgICAgcmVqZWN0KHRydWUpXG4gICAgICB9KVxuICAgIH0pXG4gICBcbiAgfSxcbiAgYWRkQ2FydChlOiBhbnkpIHtcbiAgICBsb2cubG9nKCdhZGRDYXJ0TGlzdGVuZXI6ICcgLCBlKVxuICB9IFxufSlcbiJdfQ==
